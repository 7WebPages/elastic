1. make code cleaner
2. move queries to addict
3. add some tests